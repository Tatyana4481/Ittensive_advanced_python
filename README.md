# Ittensive_advanced_python
ИМПОРТ С NUMPY и PANDAS файла *.csv
Задание:
Возьмите данные по вызовам пожарных служб в Москве за 2015-2019 годы:
https://video.ittensive.com/python-advanced/data-5283-2019-10-04.utf.csv
Получите из них фрейм данных (таблицу значений). По этому фрейму вычислите среднее значение вызовов пожарных машин в месяц в одном округе Москвы, округлив до целых
Примечание: найдите среднее значение вызовов, без учета года.

Решение:
Подключаем библиотеку Pandas. Считываем данные из файла.Заполняем нулями все пропущенные значения. Используя функцию mean рассчитываем среднее значение по столбцу вызовы (Calls), округляем полученное значение до целого числа. 

Результат:
Округленное среднее значение вызовов пожарных машин за 2015-2019 года в Москве. (493 вызова) 


Indexes and combining frames (Индексы и объединение фреймов)

Задание:  данные из нескольких источников
Получите данные по безработице в Москве:
https://video.ittensive.com/python-advanced/data-9753-2019-07-25.utf.csv
Объедините эти данные индексами (Месяц/Год) с данными из предыдущего задания (вызовы пожарных) для Центральный административный округ:
https://video.ittensive.com/python-advanced/data-5283-2019-10-04.utf.csv
Найдите значение поля UnemployedMen в том месяце, когда было меньше всего вызовов в Центральном административном округе.

Решение:
Считываем данные из двух наборов данных. В 1-ом наборе устанавливаем индексы по году и периоды (месяц). Во втором наборе данных также устанавливаем индексы по году и месяцу - это для объединения. И, также еще устанавливаем индекс по Административному округу. Объеденяем оба набора данных. После этого отменяем предыдущие индексы и устанавливаем индекс по колонке "Вызовы", сортируем ее по индексу. После этого выводим строку с индексом 0 (используя срез). И видим, что когда было меньше всего вызовов (220 штук) - безработных мужчин было 13465 человек.


Фильтрация и изменение данных.
Задание:
Получите данные по безработице в Москве:
https://video.ittensive.com/python-advanced/data-9753-2019-07-25.utf.csv
Найдите, с какого года процент людей с ограниченными возможностями (UnemployedDisabled) среди всех безработных (UnemployedTotal) стал меньше 2%.

Решение:
Импортируем наш набор данных с помощью pandas. Чтобы выполнить фильтрациюзаведем дополнительный столбец в DateFrame в котором посчитаем отношение в процентах между столбцами "люли с ограниченными возможностями" (UnemployedDisabled) и "всего безработных" (UnemployedTotal). Установим индекс по колонке "Год". Отфильтруем все значения в этом столбце, которые меньше 2% и отсортируем их. Выведем самый первый индекс(со значением 0). В результате получим искомое значение.

Задание:
Предсказание на 2020 год
Возьмите данные по безработице в городе Москва:
video.ittensive.com/python-advanced/data-9753-2019-07-25.utf.csv
Сгруппируйте данные по годам, и, если в году меньше 6 значений, отбросьте эти годы.
Постройте модель линейной регрессии по годам среднего значения отношения UnemployedDisabled к UnemployedTotal (процента людей с ограниченными возможностями) за месяц и ответьте, какое ожидается значение процента безработных инвалидов в 2020 году при сохранении текущей политики города Москвы?
Ответ округлите до сотых. Например, 2,32

Решение:
Подключаем необходимые библиотеки: numpy,  pandas, sklearn.linear_model. Загружаем данные сресурса в DateFrame. Создаем дополнительную колонку и для каждой строки вычисляем в процентном соотношении отношение количества людей с ограниченными возможностями к количеству безработных всего. Выполняем группировку по году и отбрасываем те строки (годы), если их количество за год меньше 6. Полученные данные группируем по году и считаем средние значения за каждый год.
Создаем модель с помощью model = LinearRegression(). Передаем значения x и y.
Для x: Индексы полученных сгруппированных данных приводим к двумерному массиву (используем Numpy) и изменяем размерность массива на двумерный. 
Для y: Создаем массив по рассчитанной нами и сгруппированной колонке и приводим к двумерному массиву (используем Numpy) и изменяем размерность массива на двумерный. 
Длина массива определяется длиной данных, сгруппированных по году и рассчитанными средними значениями. Следующим шагом загружаем все данные в модель линейной регрессии. Затем, с помощью функции model.predict делаем предсказание. При выводе информации для пользователя не забываем округлить до 2-х знаков после запятой. 

